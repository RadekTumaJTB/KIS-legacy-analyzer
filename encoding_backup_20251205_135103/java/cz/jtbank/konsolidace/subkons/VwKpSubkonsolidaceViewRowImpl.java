package cz.jtbank.konsolidace.subkons;
import oracle.jbo.server.ViewRowImpl;
import oracle.jbo.server.AttributeDefImpl;
import oracle.jbo.domain.Number;
import oracle.jbo.domain.Date;
import oracle.jbo.domain.RowID;
import java.io.*; //prozatim
import cz.jtbank.konsolidace.common.Constants;
import java.text.*;
import java.util.*;
import oracle.jbo.ViewObject;
import oracle.jbo.Row;
import cz.jtbank.konsolidace.doklady.common.DokladyModule;
//  ---------------------------------------------------------------
//  ---    File generated by Oracle Business Components for Java.
//  ---------------------------------------------------------------

public class VwKpSubkonsolidaceViewRowImpl extends ViewRowImpl implements cz.jtbank.konsolidace.subkons.common.VwKpSubkonsolidaceViewRow 
{


  protected static final int IDKTGUCETNISPOLECNOST = 0;
  protected static final int NLPORADI = 1;
  protected static final int IDKTGUCETNISKUPINA = 2;
  protected static final int DTPLATNOSTOD = 3;
  protected static final int DTPLATNOSTDO = 4;
  protected static final int IDCISSUBJECT = 5;
  protected static final int SICO = 6;
  protected static final int SPINID = 7;
  protected static final int TOPASID = 8;
  protected static final int QUESTID = 9;
  protected static final int CEXTSYSTEM = 10;
  protected static final int SNAZEV = 11;
  protected static final int CPOCITATROZVAHU = 12;
  protected static final int SSOUBORPREDPONA = 13;
  protected static final int SMENA = 14;
  protected static final int SDBLINK = 15;
  protected static final int CAUTOMATICKEGENEROVANI = 16;
  protected static final int IDKATEGORIE = 17;
  protected static final int CRKC = 18;
  protected static final int SZKRATKA = 19;
  protected static final int DTLASTCLOSEDATE = 20;
  protected static final int DTDATUMARCHIVACE = 21;
  protected static final int COPCE = 22;
  protected static final int IDCISKATSPOL = 23;
  protected static final int IDZODPOVEDNAUCETNI = 24;
  protected static final int IDODPOVEDNAOSOBA = 25;
  protected static final int IDADMINISTRATOR = 26;
  protected static final int DTRELATIVEDATE = 27;
  protected static final int ROWID = 28;
  protected static final int IDTOPMNG = 29;
  protected static final int STYPKURSLISTEK = 30;
  protected static final int SKOD = 31;
  protected static final int SPOPIS = 32;
  protected static final int DIRSUB = 33;
  protected static final int DIRSUBALL = 34;
  protected static final int IDKTGUCETNISPOLECNOSTMATKA = 35;
  protected static final int CKAMKURZOVYROZDIL = 36;
  protected static final int SMENAMATKA = 37;
  protected static final int NLKROKDOKLADCLENU = 38;
  protected static final int CEXPORTFLAGCZK = 39;
  
  private boolean jenAktualni;
  /**
   * 
   * This is the default constructor (do not remove)
   */
  public VwKpSubkonsolidaceViewRowImpl()
  {
  }

  /**
   * 
   * Gets VwKpSubkonsolidace entity object.
   */
  public VwKpSubkonsolidaceImpl getVwKpSubkonsolidace()
  {
    return (VwKpSubkonsolidaceImpl)getEntity(0);
  }

  /**
   * 
   * Gets the attribute value for ID_KTGUCETNISPOLECNOST using the alias name IdKtgucetnispolecnost
   */
  public Number getIdKtgucetnispolecnost()
  {
    return (Number)getAttributeInternal(IDKTGUCETNISPOLECNOST);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_KTGUCETNISPOLECNOST using the alias name IdKtgucetnispolecnost
   */
  public void setIdKtgucetnispolecnost(Number value)
  {
    setAttributeInternal(IDKTGUCETNISPOLECNOST, value);
  }

  /**
   * 
   * Gets the attribute value for NL_PORADI using the alias name NlPoradi
   */
  public Number getNlPoradi()
  {
    return (Number)getAttributeInternal(NLPORADI);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for NL_PORADI using the alias name NlPoradi
   */
  public void setNlPoradi(Number value)
  {
    setAttributeInternal(NLPORADI, value);
  }

  /**
   * 
   * Gets the attribute value for ID_KTGUCETNISKUPINA using the alias name IdKtgucetniskupina
   */
  public Number getIdKtgucetniskupina()
  {
    return (Number)getAttributeInternal(IDKTGUCETNISKUPINA);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_KTGUCETNISKUPINA using the alias name IdKtgucetniskupina
   */
  public void setIdKtgucetniskupina(Number value)
  {
    setAttributeInternal(IDKTGUCETNISKUPINA, value);
  }

  /**
   * 
   * Gets the attribute value for DT_PLATNOSTOD using the alias name DtPlatnostod
   */
  public Date getDtPlatnostod()
  {
    return (Date)getAttributeInternal(DTPLATNOSTOD);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for DT_PLATNOSTOD using the alias name DtPlatnostod
   */
  public void setDtPlatnostod(Date value)
  {
    setAttributeInternal(DTPLATNOSTOD, value);
  }

  /**
   * 
   * Gets the attribute value for DT_PLATNOSTDO using the alias name DtPlatnostdo
   */
  public Date getDtPlatnostdo()
  {
    return (Date)getAttributeInternal(DTPLATNOSTDO);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for DT_PLATNOSTDO using the alias name DtPlatnostdo
   */
  public void setDtPlatnostdo(Date value)
  {
    setAttributeInternal(DTPLATNOSTDO, value);
  }

  /**
   * 
   * Gets the attribute value for ID_CISSUBJECT using the alias name IdCissubject
   */
  public Number getIdCissubject()
  {
    return (Number)getAttributeInternal(IDCISSUBJECT);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_CISSUBJECT using the alias name IdCissubject
   */
  public void setIdCissubject(Number value)
  {
    setAttributeInternal(IDCISSUBJECT, value);
  }

  /**
   * 
   * Gets the attribute value for S_ICO using the alias name SIco
   */
  public String getSIco()
  {
    return (String)getAttributeInternal(SICO);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_ICO using the alias name SIco
   */
  public void setSIco(String value)
  {
    setAttributeInternal(SICO, value);
  }

  /**
   * 
   * Gets the attribute value for SPIN_ID using the alias name SpinId
   */
  public Number getSpinId()
  {
    return (Number)getAttributeInternal(SPINID);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for SPIN_ID using the alias name SpinId
   */
  public void setSpinId(Number value)
  {
    setAttributeInternal(SPINID, value);
  }

  /**
   * 
   * Gets the attribute value for TOPAS_ID using the alias name TopasId
   */
  public String getTopasId()
  {
    return (String)getAttributeInternal(TOPASID);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for TOPAS_ID using the alias name TopasId
   */
  public void setTopasId(String value)
  {
    setAttributeInternal(TOPASID, value);
  }

  /**
   * 
   * Gets the attribute value for QUEST_ID using the alias name QuestId
   */
  public String getQuestId()
  {
    return (String)getAttributeInternal(QUESTID);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for QUEST_ID using the alias name QuestId
   */
  public void setQuestId(String value)
  {
    setAttributeInternal(QUESTID, value);
  }

  /**
   * 
   * Gets the attribute value for C_EXTSYSTEM using the alias name CExtsystem
   */
  public String getCExtsystem()
  {
    return (String)getAttributeInternal(CEXTSYSTEM);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for C_EXTSYSTEM using the alias name CExtsystem
   */
  public void setCExtsystem(String value)
  {
    setAttributeInternal(CEXTSYSTEM, value);
  }

  /**
   * 
   * Gets the attribute value for S_NAZEV using the alias name SNazev
   */
  public String getSNazev()
  {
    return (String)getAttributeInternal(SNAZEV);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_NAZEV using the alias name SNazev
   */
  public void setSNazev(String value)
  {
    setAttributeInternal(SNAZEV, value);
  }

  /**
   * 
   * Gets the attribute value for C_POCITATROZVAHU using the alias name CPocitatrozvahu
   */
  public String getCPocitatrozvahu()
  {
    return (String)getAttributeInternal(CPOCITATROZVAHU);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for C_POCITATROZVAHU using the alias name CPocitatrozvahu
   */
  public void setCPocitatrozvahu(String value)
  {
    setAttributeInternal(CPOCITATROZVAHU, value);
  }

  /**
   * 
   * Gets the attribute value for S_SOUBORPREDPONA using the alias name SSouborpredpona
   */
  public String getSSouborpredpona()
  {
    return (String)getAttributeInternal(SSOUBORPREDPONA);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_SOUBORPREDPONA using the alias name SSouborpredpona
   */
  public void setSSouborpredpona(String value)
  {
    setAttributeInternal(SSOUBORPREDPONA, value);
  }

  /**
   * 
   * Gets the attribute value for S_MENA using the alias name SMena
   */
  public String getSMena()
  {
    return (String)getAttributeInternal(SMENA);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_MENA using the alias name SMena
   */
  public void setSMena(String value)
  {
    setAttributeInternal(SMENA, value);
  }

  /**
   * 
   * Gets the attribute value for S_DBLINK using the alias name SDblink
   */
  public String getSDblink()
  {
    return (String)getAttributeInternal(SDBLINK);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_DBLINK using the alias name SDblink
   */
  public void setSDblink(String value)
  {
    setAttributeInternal(SDBLINK, value);
  }

  /**
   * 
   * Gets the attribute value for C_AUTOMATICKEGENEROVANI using the alias name CAutomatickegenerovani
   */
  public String getCAutomatickegenerovani()
  {
    return (String)getAttributeInternal(CAUTOMATICKEGENEROVANI);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for C_AUTOMATICKEGENEROVANI using the alias name CAutomatickegenerovani
   */
  public void setCAutomatickegenerovani(String value)
  {
    setAttributeInternal(CAUTOMATICKEGENEROVANI, value);
  }

  /**
   * 
   * Gets the attribute value for ID_KATEGORIE using the alias name IdKategorie
   */
  public Number getIdKategorie()
  {
    return (Number)getAttributeInternal(IDKATEGORIE);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_KATEGORIE using the alias name IdKategorie
   */
  public void setIdKategorie(Number value)
  {
    setAttributeInternal(IDKATEGORIE, value);
  }

  /**
   * 
   * Gets the attribute value for C_RKC using the alias name CRkc
   */
  public String getCRkc()
  {
    return (String)getAttributeInternal(CRKC);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for C_RKC using the alias name CRkc
   */
  public void setCRkc(String value)
  {
    setAttributeInternal(CRKC, value);
  }

  /**
   * 
   * Gets the attribute value for S_ZKRATKA using the alias name SZkratka
   */
  public String getSZkratka()
  {
    return (String)getAttributeInternal(SZKRATKA);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_ZKRATKA using the alias name SZkratka
   */
  public void setSZkratka(String value)
  {
    setAttributeInternal(SZKRATKA, value);
  }

  /**
   * 
   * Gets the attribute value for DT_LASTCLOSEDATE using the alias name DtLastclosedate
   */
  public Date getDtLastclosedate()
  {
    return (Date)getAttributeInternal(DTLASTCLOSEDATE);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for DT_LASTCLOSEDATE using the alias name DtLastclosedate
   */
  public void setDtLastclosedate(Date value)
  {
    setAttributeInternal(DTLASTCLOSEDATE, value);
  }





  /**
   * 
   * Gets the attribute value for DT_DATUMARCHIVACE using the alias name DtDatumarchivace
   */
  public Date getDtDatumarchivace()
  {
    return (Date)getAttributeInternal(DTDATUMARCHIVACE);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for DT_DATUMARCHIVACE using the alias name DtDatumarchivace
   */
  public void setDtDatumarchivace(Date value)
  {
    setAttributeInternal(DTDATUMARCHIVACE, value);
  }

  /**
   * 
   * Gets the attribute value for C_OPCE using the alias name COpce
   */
  public String getCOpce()
  {
    return (String)getAttributeInternal(COPCE);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for C_OPCE using the alias name COpce
   */
  public void setCOpce(String value)
  {
    setAttributeInternal(COPCE, value);
  }

  /**
   * 
   * Gets the attribute value for ID_CISKATSPOL using the alias name IdCiskatspol
   */
  public Number getIdCiskatspol()
  {
    return (Number)getAttributeInternal(IDCISKATSPOL);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_CISKATSPOL using the alias name IdCiskatspol
   */
  public void setIdCiskatspol(Number value)
  {
    setAttributeInternal(IDCISKATSPOL, value);
  }

  /**
   * 
   * Gets the attribute value for ID_ZODPOVEDNAUCETNI using the alias name IdZodpovednaucetni
   */
  public Number getIdZodpovednaucetni()
  {
    return (Number)getAttributeInternal(IDZODPOVEDNAUCETNI);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_ZODPOVEDNAUCETNI using the alias name IdZodpovednaucetni
   */
  public void setIdZodpovednaucetni(Number value)
  {
    setAttributeInternal(IDZODPOVEDNAUCETNI, value);
  }

  /**
   * 
   * Gets the attribute value for ID_ODPOVEDNAOSOBA using the alias name IdOdpovednaosoba
   */
  public Number getIdOdpovednaosoba()
  {
    return (Number)getAttributeInternal(IDODPOVEDNAOSOBA);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_ODPOVEDNAOSOBA using the alias name IdOdpovednaosoba
   */
  public void setIdOdpovednaosoba(Number value)
  {
    setAttributeInternal(IDODPOVEDNAOSOBA, value);
  }

  /**
   * 
   * Gets the attribute value for ID_ADMINISTRATOR using the alias name IdAdministrator
   */
  public Number getIdAdministrator()
  {
    return (Number)getAttributeInternal(IDADMINISTRATOR);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_ADMINISTRATOR using the alias name IdAdministrator
   */
  public void setIdAdministrator(Number value)
  {
    setAttributeInternal(IDADMINISTRATOR, value);
  }

  /**
   * 
   * Gets the attribute value for DT_RELATIVEDATE using the alias name DtRelativedate
   */
  public Date getDtRelativedate()
  {
    return (Date)getAttributeInternal(DTRELATIVEDATE);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for DT_RELATIVEDATE using the alias name DtRelativedate
   */
  public void setDtRelativedate(Date value)
  {
    setAttributeInternal(DTRELATIVEDATE, value);
  }

  /**
   * 
   * Gets the attribute value for ROWID using the alias name RowID
   */
  public RowID getRowID()
  {
    return (RowID)getAttributeInternal(ROWID);
  }


  //  Generated method. Do not modify.

  protected Object getAttrInvokeAccessor(int index, AttributeDefImpl attrDef) throws Exception
  {
    switch (index)
      {
      case IDKTGUCETNISPOLECNOST:
        return getIdKtgucetnispolecnost();
      case NLPORADI:
        return getNlPoradi();
      case IDKTGUCETNISKUPINA:
        return getIdKtgucetniskupina();
      case DTPLATNOSTOD:
        return getDtPlatnostod();
      case DTPLATNOSTDO:
        return getDtPlatnostdo();
      case IDCISSUBJECT:
        return getIdCissubject();
      case SICO:
        return getSIco();
      case SPINID:
        return getSpinId();
      case TOPASID:
        return getTopasId();
      case QUESTID:
        return getQuestId();
      case CEXTSYSTEM:
        return getCExtsystem();
      case SNAZEV:
        return getSNazev();
      case CPOCITATROZVAHU:
        return getCPocitatrozvahu();
      case SSOUBORPREDPONA:
        return getSSouborpredpona();
      case SMENA:
        return getSMena();
      case SDBLINK:
        return getSDblink();
      case CAUTOMATICKEGENEROVANI:
        return getCAutomatickegenerovani();
      case IDKATEGORIE:
        return getIdKategorie();
      case CRKC:
        return getCRkc();
      case SZKRATKA:
        return getSZkratka();
      case DTLASTCLOSEDATE:
        return getDtLastclosedate();
      case DTDATUMARCHIVACE:
        return getDtDatumarchivace();
      case COPCE:
        return getCOpce();
      case IDCISKATSPOL:
        return getIdCiskatspol();
      case IDZODPOVEDNAUCETNI:
        return getIdZodpovednaucetni();
      case IDODPOVEDNAOSOBA:
        return getIdOdpovednaosoba();
      case IDADMINISTRATOR:
        return getIdAdministrator();
      case DTRELATIVEDATE:
        return getDtRelativedate();
      case ROWID:
        return getRowID();
      case IDTOPMNG:
        return getIdTopmng();
      case STYPKURSLISTEK:
        return getSTypkurslistek();
      case SKOD:
        return getSKod();
      case SPOPIS:
        return getSPopis();
      case DIRSUB:
        return getDirSub();
      case DIRSUBALL:
        return getDirSubAll();
      case IDKTGUCETNISPOLECNOSTMATKA:
        return getIdKtgucetnispolecnostmatka();
      case CKAMKURZOVYROZDIL:
        return getCKamkurzovyrozdil();
      case SMENAMATKA:
        return getSMenamatka();
      case NLKROKDOKLADCLENU:
        return getNlKrokdokladclenu();
      case CEXPORTFLAGCZK:
        return getCExportflagczk();
      default:
        return super.getAttrInvokeAccessor(index, attrDef);
      }
  }
  //  Generated method. Do not modify.

  protected void setAttrInvokeAccessor(int index, Object value, AttributeDefImpl attrDef) throws Exception
  {
    switch (index)
      {
      case IDKTGUCETNISPOLECNOST:
        setIdKtgucetnispolecnost((Number)value);
        return;
      case NLPORADI:
        setNlPoradi((Number)value);
        return;
      case IDKTGUCETNISKUPINA:
        setIdKtgucetniskupina((Number)value);
        return;
      case DTPLATNOSTOD:
        setDtPlatnostod((Date)value);
        return;
      case DTPLATNOSTDO:
        setDtPlatnostdo((Date)value);
        return;
      case IDCISSUBJECT:
        setIdCissubject((Number)value);
        return;
      case SICO:
        setSIco((String)value);
        return;
      case SPINID:
        setSpinId((Number)value);
        return;
      case TOPASID:
        setTopasId((String)value);
        return;
      case QUESTID:
        setQuestId((String)value);
        return;
      case CEXTSYSTEM:
        setCExtsystem((String)value);
        return;
      case SNAZEV:
        setSNazev((String)value);
        return;
      case CPOCITATROZVAHU:
        setCPocitatrozvahu((String)value);
        return;
      case SSOUBORPREDPONA:
        setSSouborpredpona((String)value);
        return;
      case SMENA:
        setSMena((String)value);
        return;
      case SDBLINK:
        setSDblink((String)value);
        return;
      case CAUTOMATICKEGENEROVANI:
        setCAutomatickegenerovani((String)value);
        return;
      case IDKATEGORIE:
        setIdKategorie((Number)value);
        return;
      case CRKC:
        setCRkc((String)value);
        return;
      case SZKRATKA:
        setSZkratka((String)value);
        return;
      case DTLASTCLOSEDATE:
        setDtLastclosedate((Date)value);
        return;
      case DTDATUMARCHIVACE:
        setDtDatumarchivace((Date)value);
        return;
      case COPCE:
        setCOpce((String)value);
        return;
      case IDCISKATSPOL:
        setIdCiskatspol((Number)value);
        return;
      case IDZODPOVEDNAUCETNI:
        setIdZodpovednaucetni((Number)value);
        return;
      case IDODPOVEDNAOSOBA:
        setIdOdpovednaosoba((Number)value);
        return;
      case IDADMINISTRATOR:
        setIdAdministrator((Number)value);
        return;
      case DTRELATIVEDATE:
        setDtRelativedate((Date)value);
        return;
      case IDTOPMNG:
        setIdTopmng((Number)value);
        return;
      case STYPKURSLISTEK:
        setSTypkurslistek((String)value);
        return;
      case SKOD:
        setSKod((String)value);
        return;
      case SPOPIS:
        setSPopis((String)value);
        return;
      case IDKTGUCETNISPOLECNOSTMATKA:
        setIdKtgucetnispolecnostmatka((Number)value);
        return;
      case CKAMKURZOVYROZDIL:
        setCKamkurzovyrozdil((String)value);
        return;
      case SMENAMATKA:
        setSMenamatka((String)value);
        return;
      case NLKROKDOKLADCLENU:
        setNlKrokdokladclenu((Number)value);
        return;
      case CEXPORTFLAGCZK:
        setCExportflagczk((String)value);
        return;
      default:
        super.setAttrInvokeAccessor(index, value, attrDef);
        return;
      }
  }

  private java.text.DateFormat df = java.text.DateFormat.getDateTimeInstance(java.text.DateFormat.MEDIUM, java.text.DateFormat.MEDIUM);
  
  protected FileFilter getFileFilter(final String name) 
  {
    return new FileFilter() {
      public boolean accept(File pathname) 
      {
        if(pathname.getName().indexOf(name)>-1) return true;
        return false;
      }
    };
  }

  public String getDirSubkons(String id) 
  {
    return dirSkupinyToTable(id+"_");
  }

  private String dirSkupinyToTable(String filter) 
  {
    Map soubory = null;
    String dirName = Constants.XLS_FILES_PATH + getSSouborpredpona();
    File dir = new File(dirName);
    StringBuffer buf = new StringBuffer();
    FileFilter ff = getFileFilter(filter);
    File[] arr = dir.listFiles(ff);
    if(arr != null) {
      for( int i=0; i<arr.length; i++ ) 
      {
        soubory = addSoubor(soubory, arr[i]);
      }
    }
    
    if(soubory != null) 
    {
      buf.append("<table width='100%'>");
      Set keys = soubory.keySet();
      Iterator keyIter = keys.iterator();
      while(keyIter.hasNext()) 
      {
        String key = (String)keyIter.next();
        Set vals = (Set) soubory.get(key);
        String html = getHtml(key,vals);
        if(html != null)
          buf.append(html);
      }
      buf.append("</table>");
    }
/*    
    if(jenAktualni) {
      buf.append("<div class='clsNextDates'><a href=\"DokladySubkonsStarsi.jsp?idSub="+getIdKtgucetnispolecnost()+"&skupId="+getIdKtgucetniskupina()+"\">Doklady nejen pro aktuální rok</a></div>");
    }
*/    
    if(buf.length()==0) return null;
    return buf.toString();
  }

  private Comparator reverzne = new Comparator() 
  {
    public int compare(Object obj1, Object obj2) 
    {
      String str1 = (String) obj1;
      String str2 = (String) obj2;
      return -1 * str1.compareTo(str2);
    }
  };

  private static SimpleDateFormat sdfBack = new SimpleDateFormat("yyyy-MM-dd");

  private String dttr = null;

  private String getCurrentGenDate() 
  {
    if(dttr != null) return dttr;
    
    if(dokladyModule==null) dokladyModule = (DokladyModule)getApplicationModule();
    ViewObject voDate = dokladyModule.findViewObject("KpParametryView1");
    voDate.clearCache();
    if(voDate.hasNext()) 
    {
      Row row = voDate.next();
      oracle.jbo.domain.Date hlp = (oracle.jbo.domain.Date) row.getAttribute("DtGensubkonsolidaci");
      if(hlp!=null) 
      {
        dttr = sdfBack.format(hlp.dateValue());
      }
    }
    voDate.closeRowSet();
    
    return dttr;
  }
  
  private String curYear = ""+Calendar.getInstance().get(Calendar.YEAR);

  private Map addSoubor(Map map, File soubor) 
  {
    if(map == null) map = new TreeMap(reverzne);
    
    int dtZac = soubor.getName().lastIndexOf('_')+1;
    int dtKon = soubor.getName().lastIndexOf('.');
    String key = soubor.getName().substring(dtZac, dtKon);
    
    getCurrentGenDate();
    if(!jenAktualni || key.equals(dttr)) {
      if(map.containsKey(key)) 
      {
        Set val = (Set) map.get(key);
        val.add(soubor);
      }
      else 
      {
        Set val = new TreeSet();
        val.add(soubor);
        map.put(key, val);
      }
    }
    
    return map;
  }

  private Number getDokladByParams(String idSub, String datum) 
  {
    Number ret = null;
    ViewObject vo = getApplicationModule().findViewObject("KpDatDokladView1");
    vo.clearCache();
    vo.setWhereClause("ID_SUBKONSOLIDACE = "+idSub+" AND DT_DATUM = TO_DATE('"+datum+"','yyyy-mm-dd') AND NL_KROK = 200");
    if(vo.hasNext()) 
    {
      Row row = vo.next();
      ret = (Number) row.getAttribute("Id");
    }
    vo.closeRowSet();
    return ret;
  }

  private DokladyModule dokladyModule = null;

  private String getHtml(String dtDatum, Set soubory) 
  {
    if(soubory==null || soubory.isEmpty()) return null;

    if(dokladyModule==null) dokladyModule = (DokladyModule)getApplicationModule();
    
    //getApplicationModule().findApplicationModule("DokladyModule")???

    StringBuffer buf = new StringBuffer();    
    String checkboxy;
    buf.append("<tr><td>");
    checkboxy = dokladyModule.getZamekCheckboxy(getIdKtgucetnispolecnost().intValue(), dtDatum);
    buf.append(checkboxy);
    if(checkboxy==null || checkboxy.indexOf("checked")<0) {
      buf.append("<a href=\"DokladySubkonsDelete.jsp?dir="+getSSouborpredpona()+"&datum="+dtDatum+"&idSub="+getIdKtgucetnispolecnost()+"\" title=\"Smazat\">DEL</a>\n");
    }
    buf.append("</td><td>");
    Iterator iter = soubory.iterator();
    while(iter.hasNext()) 
    {
      File soubor = (File) iter.next();
      String name = soubor.getName();
      
      String styleLink = getStyleLink(name);
      buf.append("<a target=\"_blank\" href=\"excelservlet/"+name+"?file=" + getSSouborpredpona() + "|5C" + name + "\" "+styleLink+">" + name + "</a>");
      buf.append("&nbsp;" + df.format( new java.util.Date(soubor.lastModified())) + "&nbsp;"); 
      if(name.startsWith("Subkons")) 
      {
        int idx = name.indexOf('_');
        String idSub = name.substring(name.indexOf('1'),idx);
        String datum = name.substring(idx+1,name.indexOf('.'));
        Number idDoklad = getDokladByParams(idSub,datum);
        if(idDoklad!=null) {
          buf.append("<a href=\"LogsSubkonsDetail.jsp?idSub="+idSub+"&datum="+datum+"\" title=\"Protokol s logy\">Logs</a>");
          buf.append("&nbsp;<a href=\"KamilSubkonPrehled.jsp?idSub="+idSub+"&datum="+datum+"\" title=\"Rozklad pøes èleny (Kamil)\">K</a>");
          //buf.append("&nbsp;<a href=\"KamilPrehledRozklad.jsp?idDoklad="+idDoklad+"\" title=\"Rozklady dokladu prozatimní (Kamil)\">K(p)</a>");
        }
        else {
          buf.append("<a href=\"FileDeleteOwn.jsp?file=data|5C" + getSSouborpredpona() + "|5C" + soubor.getName() + "\" title=\"Smazat excel bez dokladu.\">Del</a>");
          //buf.append("&nbsp;Neex.&nbsp;v&nbsp;DB");
        }
      }
      buf.append("<br>\n");
    }
    buf.append("</td></tr>");
    
    return buf.toString();
  }

  private String getStyleLink(String name) 
  {
    if(name.indexOf("Mis")>-1) return "style='color: green'";
    if(name.indexOf("Blue")>-1) return "style='background-color: #a0a0ff'";
    else return "";
  }

  /**
   * 
   * Gets the attribute value for ID_TOPMNG using the alias name IdTopmng
   */
  public Number getIdTopmng()
  {
    return (Number)getAttributeInternal(IDTOPMNG);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_TOPMNG using the alias name IdTopmng
   */
  public void setIdTopmng(Number value)
  {
    setAttributeInternal(IDTOPMNG, value);
  }

  /**
   * 
   * Gets the attribute value for S_TYPKURSLISTEK using the alias name STypkurslistek
   */
  public String getSTypkurslistek()
  {
    return (String)getAttributeInternal(STYPKURSLISTEK);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_TYPKURSLISTEK using the alias name STypkurslistek
   */
  public void setSTypkurslistek(String value)
  {
    setAttributeInternal(STYPKURSLISTEK, value);
  }

  /**
   * 
   * Gets the attribute value for S_KOD using the alias name SKod
   */
  public String getSKod()
  {
    return (String)getAttributeInternal(SKOD);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_KOD using the alias name SKod
   */
  public void setSKod(String value)
  {
    setAttributeInternal(SKOD, value);
  }

  /**
   * 
   * Gets the attribute value for S_POPIS using the alias name SPopis
   */
  public String getSPopis()
  {
    return (String)getAttributeInternal(SPOPIS);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_POPIS using the alias name SPopis
   */
  public void setSPopis(String value)
  {
    setAttributeInternal(SPOPIS, value);
  }

  /**
   * 
   * Gets the attribute value for the calculated attribute DirSub
   */
  public String getDirSub()
  {
    jenAktualni = true;
    return dirSkupinyToTable(getIdKtgucetnispolecnost()+"_");
  }

  /**
   * 
   * Sets <code>value</code> as the attribute value for the calculated attribute DirSub
   */
  public void setDirSub(String value)
  {
    setAttributeInternal(DIRSUB, value);
  }

  /**
   * 
   * Gets the attribute value for the calculated attribute DirSubAll
   */
  public String getDirSubAll()
  {
    jenAktualni = false;
    return dirSkupinyToTable(getIdKtgucetnispolecnost()+"_");
  }

  /**
   * 
   * Sets <code>value</code> as the attribute value for the calculated attribute DirSubAll
   */
  public void setDirSubAll(String value)
  {
    setAttributeInternal(DIRSUBALL, value);
  }

  /**
   * 
   * Gets the attribute value for ID_KTGUCETNISPOLECNOSTMATKA using the alias name IdKtgucetnispolecnostmatka
   */
  public Number getIdKtgucetnispolecnostmatka()
  {
    return (Number)getAttributeInternal(IDKTGUCETNISPOLECNOSTMATKA);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for ID_KTGUCETNISPOLECNOSTMATKA using the alias name IdKtgucetnispolecnostmatka
   */
  public void setIdKtgucetnispolecnostmatka(Number value)
  {
    setAttributeInternal(IDKTGUCETNISPOLECNOSTMATKA, value);
  }

  /**
   * 
   * Gets the attribute value for C_KAMKURZOVYROZDIL using the alias name CKamkurzovyrozdil
   */
  public String getCKamkurzovyrozdil()
  {
    return (String)getAttributeInternal(CKAMKURZOVYROZDIL);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for C_KAMKURZOVYROZDIL using the alias name CKamkurzovyrozdil
   */
  public void setCKamkurzovyrozdil(String value)
  {
    setAttributeInternal(CKAMKURZOVYROZDIL, value);
  }

  /**
   * 
   * Gets the attribute value for S_MENAMATKA using the alias name SMenamatka
   */
  public String getSMenamatka()
  {
    return (String)getAttributeInternal(SMENAMATKA);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for S_MENAMATKA using the alias name SMenamatka
   */
  public void setSMenamatka(String value)
  {
    setAttributeInternal(SMENAMATKA, value);
  }

  /**
   * 
   * Gets the attribute value for NL_KROKDOKLADCLENU using the alias name NlKrokdokladclenu
   */
  public Number getNlKrokdokladclenu()
  {
    return (Number)getAttributeInternal(NLKROKDOKLADCLENU);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for NL_KROKDOKLADCLENU using the alias name NlKrokdokladclenu
   */
  public void setNlKrokdokladclenu(Number value)
  {
    setAttributeInternal(NLKROKDOKLADCLENU, value);
  }

  /**
   * 
   * Gets the attribute value for C_EXPORTFLAGCZK using the alias name CExportflagczk
   */
  public String getCExportflagczk()
  {
    return (String)getAttributeInternal(CEXPORTFLAGCZK);
  }

  /**
   * 
   * Sets <code>value</code> as attribute value for C_EXPORTFLAGCZK using the alias name CExportflagczk
   */
  public void setCExportflagczk(String value)
  {
    setAttributeInternal(CEXPORTFLAGCZK, value);
  }
}